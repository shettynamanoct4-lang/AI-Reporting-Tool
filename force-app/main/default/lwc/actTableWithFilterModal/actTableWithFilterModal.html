<template>
    <lightning-card title="Account Records" icon-name="standard:account">
        <!-- Clear button -->
        <div class="slds-m-bottom_medium">
            <lightning-button variant="destructive" label="Delete" onclick={handleDelete} disabled={isDeleteDisabled}></lightning-button>
            <lightning-button variant="neutral" label="Clear" onclick={handleClear}></lightning-button>
            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-4 slds-text-align_right">
                <lightning-input type="search" class="custom-search-input" placeholder="Please enter minimum 3 characters" onchange={handleSearch}></lightning-input>
            </div>
        </div>

        <!-- Table with Account Records -->
        <div class="slds-table_header-fixed_container">
            <table class="slds-table slds-table--bordered slds-table--cell-buffer">
                <thead>
                    <tr class="slds-text-title--caps">
                        <th>
                            <input type="checkbox" onchange={handleSelectAll} />
                        </th>
                        <th data-id="Name" onclick={sortName}>
                            <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                <span class="slds-assistive-text">Sort</span>
                                <div class="slds-truncate" title="Name">
                                    Name
                                    <lightning-icon icon-name="utility:filter" size="x-small" onclick={openModal} data-field="Name"></lightning-icon>
                                    <div if:true={isNameSort}>
                                        <div if:true={isAsc}>
                                            &#9650;
                                        </div>
                                        <div if:true={isDsc}>
                                            &#9660;
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate" title="Phone">
                                Phone 
                                <lightning-icon icon-name="utility:filter" size="x-small" onclick={openModal} data-field="Phone"></lightning-icon>
                                
                            </div>
                        </th>
                        <th data-id="Rating" onclick={sortRating}>
                            <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                <span class="slds-assistive-text">Sort</span>
                                <div class="slds-truncate" title="Rating">
                                    Rating
                                    <lightning-icon icon-name="utility:filter" size="x-small" onclick={openModal} data-field="Rating"></lightning-icon>
                                    <div if:true={isRatingSort}>
                                        <div if:true={isAsc}>
                                            &#9650;
                                        </div>
                                        <div if:true={isDsc}>
                                            &#9660;
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <template for:each={accounts} for:item="account">
                        <tr key={account.Id} class="slds-hint-parent">
                            <td data-label="Select">
                                <input type="checkbox" data-id={account.Id} onchange={handleRowSelect} />
                            </td>
                            <td data-label="Name">
                                <div class="slds-truncate" title={account.Name}>{account.Name}</div>
                            </td>
                            <td data-label="Phone">
                                <div class="slds-truncate" title={account.Phone}>{account.Phone}</div>
                            </td>
                            <td data-label="Rating">
                                <div class="slds-truncate" title={account.Rating}>{account.Rating}</div>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>
        </div>

        <!-- Modal for Filters -->
        <template if:true={showModal}>
            <div class="slds-backdrop_open"></div>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={handleModalClose}>
                            <lightning-icon icon-name="utility:close" alternative-text="close" size="small"></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 class="slds-text-heading_medium">Filter</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium">
                        <c-filter-pop onapply={applyFilter} onclosemodal={handleModalClose}></c-filter-pop>
                    </div>
                </div>
            </section>
        </template>
    </lightning-card>
</template>