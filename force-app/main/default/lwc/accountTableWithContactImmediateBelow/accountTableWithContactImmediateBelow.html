<template>
    <lightning-card title="Accounts">
        <table class="slds-table slds-table_bordered slds-table_cell-buffer">
            <thead>
                <tr>
                    <th scope="col">Account Name</th>
                    <th scope="col">Rating</th>
                    <th scope="col">Status</th>
                </tr>
            </thead>
            <tbody>
                <template for:each={accounts} for:item="account" for:index="index">
                    <!-- Account row -->
                    <tr key={account.Id}>
                        <td>
                            <a href="javascript:void(0)" data-account-id={account.Id} data-index={index}
                                onclick={handleRowClick}>
                                {account.Name}
                            </a>
                        </td>
                        <td>{account.Rating}</td>
                        <td>{account.Status}</td>
                    </tr>

                    <!-- Expanded contact list row -->
                    <template if:true={account.isExpanded}>
                        <tr key={account.key}>
                            <td colspan="3">
                                <lightning-spinner if:true={isLoading}></lightning-spinner>
                                <template if:true={hasContacts}>
                                    <p>Contacts:</p>
                                    <ul>
                                        <template for:each={contacts} for:item="contact">
                                            <li key={contact.Id}>{contact.Name}</li>
                                        </template>
                                    </ul>
                                </template>
                                <template if:true={noContactsAvailable}>
                                    <p>No contacts available.</p>
                                </template>
                            </td>
                        </tr>
                    </template>
                </template>
            </tbody>
        </table>
    </lightning-card>
</template>